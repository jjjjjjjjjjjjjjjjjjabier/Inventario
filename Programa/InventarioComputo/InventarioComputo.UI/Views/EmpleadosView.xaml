<UserControl x:Class="InventarioComputo.UI.Views.EmpleadosView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:sys="clr-namespace:System;assembly=System.Runtime"
             Loaded="UserControl_Loaded"
             mc:Ignorable="d">

    <Grid Margin="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Barra superior: buscador, filtro inactivos y botones -->
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <StackPanel Orientation="Horizontal">
                <!-- Buscador -->
                <TextBox Width="300" 
                         HorizontalAlignment="Left" 
                         Text="{Binding FiltroTexto, UpdateSourceTrigger=PropertyChanged}"
                         Margin="0,0,8,0">
                    <TextBox.Style>
                        <Style TargetType="TextBox">
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="TextBox">
                                        <Grid>
                                            <ScrollViewer x:Name="PART_ContentHost"/>
                                            <TextBlock Margin="4,2,0,0" 
                                                       Foreground="Gray" 
                                                       IsHitTestVisible="False" 
                                                       Text="Buscar empleado..." 
                                                       Visibility="{Binding Text.IsEmpty, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                        </Grid>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </TextBox.Style>
                </TextBox>

                <!-- Checkbox mostrar inactivos -->
                <CheckBox Content="Mostrar inactivos" 
                          Margin="8,4,0,0" 
                          VerticalAlignment="Center"
                          IsChecked="{Binding MostrarInactivos}"/>
            </StackPanel>

            <!-- Botones de accion -->
            <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
                <Button Content="Nuevo" 
                        Command="{Binding CrearCommand}" 
                        Width="80" 
                        Margin="8,0,0,0"/>
                <Button Content="Editar" 
                        Command="{Binding EditarCommand}" 
                        Width="80" 
                        Margin="8,0,0,0"/>
                <Button Content="Eliminar" 
                        Command="{Binding EliminarCommand}" 
                        Width="80" 
                        Margin="8,0,0,0"/>
            </StackPanel>
        </Grid>

        <!-- DataGrid de empleados -->
        <DataGrid Grid.Row="1" 
                  Margin="0,8,0,0"
                  ItemsSource="{Binding Empleados}" 
                  SelectedItem="{Binding EmpleadoSeleccionado}"
                  AutoGenerateColumns="False"
                  IsReadOnly="True"
                  GridLinesVisibility="Horizontal"
                  BorderThickness="1"
                  Background="White">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Nombre" Binding="{Binding NombreCompleto}" Width="*"/>
                <DataGridTextColumn Header="Puesto" Binding="{Binding Puesto}" Width="250"/>
                <DataGridTemplateColumn Header="Estado" Width="100">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Activo, Converter={StaticResource BoolToActivoConverter}}" 
                                       Foreground="{Binding Activo, Converter={StaticResource StatusColorConverter}}"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>

        <!-- Indicador de carga -->
        <Border Grid.Row="1" 
                Background="#80000000"
                Visibility="{Binding IsBusy, Converter={StaticResource BooleanToVisibilityConverter}}">
            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                <TextBlock Text="Cargando..." Foreground="White" FontSize="16" HorizontalAlignment="Center"/>
                <ProgressBar IsIndeterminate="True" Height="4" Width="200" Margin="0,4,0,0"/>
            </StackPanel>
        </Border>
    </Grid>
</UserControl>