<UserControl x:Class="InventarioComputo.UI.Views.ReportesView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:InventarioComputo.UI.Views"
             mc:Ignorable="d" 
             Loaded="UserControl_Loaded">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="250"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- Panel de Filtros (Izquierda) -->
        <Border Grid.Column="0" Background="#f5f5f5" BorderBrush="#ddd" BorderThickness="0,0,1,0">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <StackPanel Margin="10">
                    <TextBlock Text="FILTROS" FontWeight="Bold" Margin="0,0,0,10"/>

                    <!-- Tipo Equipo -->
                    <TextBlock Text="Tipo de Equipo:" Margin="0,5,0,2"/>
                    <ComboBox ItemsSource="{Binding TiposEquipo}" 
                              SelectedItem="{Binding TipoEquipoSeleccionado}"
                              DisplayMemberPath="Nombre"
                              Margin="0,0,0,10"/>

                    <!-- Estado -->
                    <TextBlock Text="Estado:" Margin="0,5,0,2"/>
                    <ComboBox ItemsSource="{Binding Estados}" 
                              SelectedItem="{Binding EstadoSeleccionado}"
                              DisplayMemberPath="Nombre"
                              Margin="0,0,0,10"/>

                    <!-- Sede -->
                    <TextBlock Text="Sede:" Margin="0,5,0,2"/>
                    <ComboBox ItemsSource="{Binding Sedes}" 
                              SelectedItem="{Binding SedeSeleccionada}"
                              DisplayMemberPath="Nombre"
                              Margin="0,0,0,10"/>

                    <!-- Área -->
                    <TextBlock Text="Área:" Margin="0,5,0,2"/>
                    <ComboBox ItemsSource="{Binding Areas}" 
                              SelectedItem="{Binding AreaSeleccionada}"
                              DisplayMemberPath="Nombre"
                              Margin="0,0,0,10"/>

                    <!-- Zona -->
                    <TextBlock Text="Zona:" Margin="0,5,0,2"/>
                    <ComboBox ItemsSource="{Binding Zonas}" 
                              SelectedItem="{Binding ZonaSeleccionada}"
                              DisplayMemberPath="Nombre"
                              Margin="0,0,0,10"/>

                    <!-- Usuario Asignado -->
                    <TextBlock Text="Usuario Asignado:" Margin="0,5,0,2"/>
                    <ComboBox ItemsSource="{Binding Usuarios}" 
                              SelectedItem="{Binding UsuarioSeleccionado}"
                              DisplayMemberPath="NombreCompleto"
                              Margin="0,0,0,10"/>

                    <!-- Fechas -->
                    <TextBlock Text="Fecha Desde:" Margin="0,5,0,2"/>
                    <DatePicker SelectedDate="{Binding FechaDesde}" Margin="0,0,0,10"/>

                    <TextBlock Text="Fecha Hasta:" Margin="0,5,0,2"/>
                    <DatePicker SelectedDate="{Binding FechaHasta}" Margin="0,0,0,10"/>

                    <!-- Incluir inactivos -->
                    <CheckBox Content="Incluir Inactivos" IsChecked="{Binding IncluirInactivos}" Margin="0,5,0,15"/>

                    <!-- Botones -->
                    <Button Content="Generar Reporte" Command="{Binding GenerarReporteCommand}" 
                            Background="#0078D7" Foreground="White"
                            Padding="10,5" Margin="0,0,0,10"/>

                    <Button Content="Limpiar Filtros" Command="{Binding LimpiarFiltrosCommand}" 
                            Background="#6c757d" Foreground="White"
                            Padding="10,5" Margin="0,0,0,10"/>

                    <TextBlock Text="EXPORTAR" FontWeight="Bold" Margin="0,10,0,10"/>

                    <Button Content="Exportar a Excel" Command="{Binding ExportarExcelCommand}"
                            Background="#28a745" Foreground="White"
                            Padding="10,5" Margin="0,0,0,10"/>

                    <Button Content="Exportar a PDF" Command="{Binding ExportarPDFCommand}"
                            Background="#dc3545" Foreground="White"
                            Padding="10,5" Margin="0,0,0,10"/>
                </StackPanel>
            </ScrollViewer>
        </Border>

        <!-- Resultados (Derecha) -->
        <Grid Grid.Column="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Título -->
            <TextBlock Grid.Row="0" Text="Resultados del Reporte" 
                       FontSize="18" FontWeight="SemiBold" 
                       Margin="20,10,0,10"/>

            <!-- DataGrid con resultados -->
            <DataGrid Grid.Row="1" ItemsSource="{Binding Resultados}" 
                      AutoGenerateColumns="False" IsReadOnly="True"
                      Margin="20,0,20,20" BorderThickness="1" BorderBrush="#ddd">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Serie" Binding="{Binding NumeroSerie}" Width="120"/>
                    <DataGridTextColumn Header="Inventario" Binding="{Binding EtiquetaInventario}" Width="120"/>
                    <DataGridTextColumn Header="Tipo" Binding="{Binding TipoEquipo.Nombre}" Width="100"/>
                    <DataGridTextColumn Header="Marca" Binding="{Binding Marca}" Width="100"/>
                    <DataGridTextColumn Header="Modelo" Binding="{Binding Modelo}" Width="100"/>
                    <DataGridTextColumn Header="Estado" Binding="{Binding Estado.Nombre}" Width="80"/>
                    <DataGridTextColumn Header="Usuario" Binding="{Binding Usuario.NombreCompleto}" Width="150"/>
                    <DataGridTextColumn Header="Ubicación" Binding="{Binding Zona.Nombre}" Width="120"/>
                    <DataGridTextColumn Header="Fecha Adquisición" Binding="{Binding FechaAdquisicion, StringFormat=\{0:dd/MM/yyyy\}}" Width="120"/>
                </DataGrid.Columns>
            </DataGrid>

            <!-- Overlay de carga -->
            <Grid Grid.Row="1" Background="#80FFFFFF" 
                  Visibility="{Binding IsBusy, Converter={StaticResource BoolToVis}}">
                <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                    <TextBlock Text="Cargando datos..." FontSize="16" Margin="0,0,0,10"/>
                    <ProgressBar IsIndeterminate="True" Width="200" Height="5"/>
                </StackPanel>
            </Grid>
        </Grid>
    </Grid>
</UserControl>